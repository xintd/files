mixed-port: 51168
allow-lan: false
mode: rule                          #clashå·¥ä½œæ¨¡å¼ï¼ˆrule/global/direct,metaæš‚ä¸æ”¯æŒscriptï¼‰
log-level: info                  #æ—¥å¿—ç­‰çº§ï¼ˆinfo/warning/error/debug/silentï¼‰
ipv6: true                          #ip6å¼€å…³ï¼Œå½“ä¸ºfalseæ—¶ï¼Œåœæ­¢è§£æhostanmesä¸ºip6åœ°å€
external-controller: 127.0.0.1:9090      #æ§åˆ¶å™¨ç›‘å¬åœ°å€
profile:                   #ç¼“å­˜è®¾ç½®(æ–‡ä»¶ä½ç½®./cache.db)
  store-selected: false    #èŠ‚ç‚¹çŠ¶æ€è®°å¿†ï¼ˆè‹¥ä¸åŒé…ç½®æœ‰åŒä»£ç†åç§°,è®¾ç½®å€¼å…±äº«ï¼‰
  store-fake-ip: true      #fake-ipç¼“å­˜

#geodata-mode: true         #ã€Metaä¸“å±ã€‘ä½¿ç”¨geoip.datæ•°æ®åº“(é»˜è®¤ï¼šfalseä½¿ç”¨mmdbæ•°æ®åº“)
tcp-concurrent: true         #ã€Metaä¸“å±ã€‘TCPè¿æ¥å¹¶å‘ï¼Œå¦‚æœåŸŸåè§£æç»“æœå¯¹åº”å¤šä¸ªIPï¼Œ
                                         # å¹¶å‘æ‰€æœ‰IPï¼Œé€‰æ‹©æ¡æ‰‹æœ€å¿«çš„IPè¿›è¡Œè¿æ¥
# Enable the TUN listener
tun:
  enable: true
  device: meta
  stack: system
  dns-hijack:
    - '0.0.0.0:53'
  auto-detect-interface: true
  auto-route: true # auto set global route
# port: 7890                 #æœ¬åœ°httpä»£ç†ç«¯å£
# socks-port: 7891           #æœ¬åœ°socks5ä»£ç†ç«¯å£
# authentication:            # æœ¬åœ°SOCKS5/HTTP(S)ä»£ç†ç«¯å£è®¤è¯è®¾ç½®
#  - "user1:pass1"
#  - "user2:pass2"

sniffer:                         #ã€Metaä¸“å±ã€‘snifferåŸŸåå—…æ¢å™¨
  enable: true                   #å—…æ¢å¼€å…³
  sniffing:                      #å—…æ¢åè®®å¯¹è±¡ï¼šç›®å‰æ”¯æŒtls/http
    - tls
    - http
  skip-domain:                   #åˆ—è¡¨ä¸­çš„sniå­—æ®µï¼Œä¿ç•™mappingç»“æœï¼Œä¸é€šè¿‡å—…æ¢è¿˜åŸåŸŸå
                                 #ä¼˜å…ˆçº§æ¯”force-domainé«˜
    - 'Mijia Cloud'              #ç±³å®¶è®¾å¤‡ï¼Œå»ºè®®åŠ 
    - 'dlg.io.mi.com'
    - '+.apple.com'              #è‹¹æœåŸŸåï¼Œå»ºè®®åŠ 
  # - '*.baidu.com'              #æ”¯æŒé€šé…ç¬¦

  force-domain:                  #éœ€è¦å¼ºåˆ¶å—…æ¢çš„åŸŸåï¼Œé»˜è®¤åªå¯¹IPå—…æ¢
  # - '+'                        #å»æ‰æ³¨é‡Šåç­‰äºå…¨å±€å—…æ¢
    - 'google.com'
dns:
  enable: true                 #DNSå¼€å…³(false/true)
  listen: 0.0.0.0:53           #DNSç›‘å¬åœ°å€
  # ipv6: false                #IP6è§£æå¼€å…³ï¼›å¦‚æœä¸ºfalseï¼Œå°†è¿”å›ip6ç»“æœä¸ºç©º

  default-nameserver:          #è§£æéIPçš„dnsç”¨çš„dnsæœåŠ¡å™¨,åªæ”¯æŒçº¯IP
    - 114.114.114.114
    - 8.8.8.8

  #nameserver-policy:                #æŒ‡å®šåŸŸåä½¿ç”¨è‡ªå®šä¹‰DNSè§£æ
  # '+.internal.crop.com': '114.114.114.114'

  enhanced-mode: redir-host          #DNSæ¨¡å¼(redir-host/fake-ip)
                                                        #ã€Metaä¸“å±ã€‘redir-hostä¼ é€’åŸŸåï¼Œå¯è¿œç¨‹è§£æ
  fake-ip-range: 198.18.0.1/16       #Fake-IPè§£æåœ°å€æ± 
  # use-hosts: true                  #æŸ¥è¯¢hostsé…ç½®å¹¶è¿”å›çœŸå®IP

  # fake-ip-filter:                  #Fake-ipè¿‡æ»¤ï¼Œåˆ—è¡¨ä¸­çš„åŸŸåè¿”å›çœŸå®ip
  #   - '*.lan'
  #   - '*.linksys.com'
  #   - '+.pool.ntp.org'
  #   - localhost.ptlogin2.qq.com

  #proxy-server-nameserver:          #ã€Metaä¸“å±ã€‘è§£æä»£ç†æœåŠ¡å™¨åŸŸåçš„dns
  # - tls://1.0.0.1:853              # ä¸å†™æ—¶ç”¨nameserverè§£æ

  nameserver:                        #é»˜è®¤DNSæœåŠ¡å™¨ï¼Œæ”¯æŒudp/tcp/dot/doh/doq
    - 114.114.114.114
    - https://doh.pub/dns-query
    - tls://1.1.1.1:853

proxy-providers:
  clash:
    type: http
    path: ./proxies/clash.yaml
    url: https://raw.gfile.ga/https://raw.githubusercontent.com/xintd/TopFreeProxies/master/Eternity.yaml  #ã€Metaä¸“å±ã€‘æ”¯æŒè§£æV2rayNç­‰å·¥å…·ä½¿ç”¨çš„æ™®é€šè®¢é˜…
    interval: 900
    health-check:
      enable: true
      url: http://www.apple.com/library/test/success.html
      interval: 300
  portx:
    type: http
    path: ./proxies/portx.yaml
    url: "https://earr.one/link/ATBMcu1CdMHnS0pk?sub=3"  #ã€Metaä¸“å±ã€‘æ”¯æŒè§£æV2rayNç­‰å·¥å…·ä½¿ç”¨çš„æ™®é€šè®¢é˜…
    interval: 900
    health-check:
      enable: true
      url: http://www.apple.com/library/test/success.html
      interval: 300

proxy-groups:
  - name: ğŸš€ PROXY
    type: url-test
    interval: 300
    url: https://www.google.com/gen_204
    strategy: round-robin   # load-balance ç­–ç•¥ï¼šround-robin ï¼šæ‰€æœ‰è¯·æ±‚ä¸ä½¿ç”¨åŒä¸€ä»£ç†
                            #     consistent-hashingï¼šåŒä¸€æœ‰æ•ˆé¡¶çº§åŸŸå(eTLD)ä½¿ç”¨åŒä¸€ä»£ç†
    proxies:
      - HK&MO
      - CA&AU
      - SG
      - US
      - Europe
      - JP
      - KR
      - ZZ
      - portx.
  - name: portx.
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)^((?!http|è®¢é˜…).)*$'
    use:
      - portx
  - name: HK&MO
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(æ¸¯|HK|Hong|MO|æ¾³é—¨)'
    use:
      - clash
  - name: CA&AU
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(åŠ æ‹¿å¤§|CA|AU|æ¾³å¤§)'
    use:
      - clash
  - name: SG
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(æ–°åŠ å¡|SG)'
    use:
      - clash
  - name: US
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(ç¾|US|United States)'
    use:
      - clash
  - name: Europe
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(å¾·|DE|FR|æ³•|NL|FI)'
    use:
      - clash
  - name: JP
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(æ—¥|JP)'
    use:
      - clash
  - name: KR
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)(éŸ©|éŸ“|KR)'
    use:
      - clash
  - name: ZZ
    type: url-test
    interval: 300
    tolerance: 100
    url: http://www.apple.com/library/test/success.html
    filter: '(?i)^((?!æ¸¯|HK|Hong|MO|åŠ æ‹¿å¤§|CA|æ–°åŠ å¡|SG|ç¾|US|å¾·|DE|FR|æ³•|NL|FI|æ—¥|JP|éŸ©|éŸ“|KR|AU|æ¾³).)*$'
    use:
      - clash

rule-providers:
  reject: # å¹¿å‘ŠåŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/reject.yaml
    interval: 86400

  icloud: # iCloud åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple: # Apple åœ¨ä¸­å›½å¤§é™†å¯ç›´è¿çš„åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  google: # Google åœ¨ä¸­å›½å¤§é™†å¯ç›´è¿çš„åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
    path: ./ruleset/google.yaml
    interval: 86400

  proxy: # ä»£ç†åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  direct: # ç›´è¿åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private: # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw: # GFWList åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  greatfire: # GreatFire åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/greatfire.txt"
    path: ./ruleset/greatfire.yaml
    interval: 86400

  tld-not-cn: # éä¸­å›½å¤§é™†ä½¿ç”¨çš„é¡¶çº§åŸŸååˆ—è¡¨
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400

  telegramcidr: # Telegram ä½¿ç”¨çš„ IP åœ°å€åˆ—è¡¨
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegramcidr.yaml
    interval: 86400

  cncidr: # ä¸­å›½å¤§é™† IP åœ°å€åˆ—è¡¨
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr: # å±€åŸŸç½‘ IP åŠä¿ç•™ IP åœ°å€åˆ—è¡¨
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

  applications: # éœ€è¦ç›´è¿çš„å¸¸è§è½¯ä»¶åˆ—è¡¨
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: ./ruleset/applications.yaml
    interval: 86400

rules:
  - DOMAIN,raw.gfile.ga,DIRECT     #è®¢é˜…æ–‡ä»¶ç›´è¿ä¸‹è½½
  - DOMAIN,cdn.jsdelivr.net,DIRECT     #è§„åˆ™æ–‡ä»¶ç›´è¿ä¸‹è½½
  - PROCESS-NAME,v2ray,DIRECT
  - PROCESS-NAME,xray,DIRECT
  - PROCESS-NAME,naive,DIRECT
  - PROCESS-NAME,trojan,DIRECT
  - PROCESS-NAME,trojan-go,DIRECT
  - PROCESS-NAME,ss-local,DIRECT
  - PROCESS-NAME,privoxy,DIRECT
  - PROCESS-NAME,leaf,DIRECT
  - PROCESS-NAME,v2ray.exe,DIRECT
  - PROCESS-NAME,xray.exe,DIRECT
  - PROCESS-NAME,naive.exe,DIRECT
  - PROCESS-NAME,trojan.exe,DIRECT
  - PROCESS-NAME,trojan-go.exe,DIRECT
  - PROCESS-NAME,ss-local.exe,DIRECT
  - PROCESS-NAME,privoxy.exe,DIRECT
  - PROCESS-NAME,leaf.exe,DIRECT
  - PROCESS-NAME,Surge,DIRECT
  - PROCESS-NAME,Surge 2,DIRECT
  - PROCESS-NAME,Surge 3,DIRECT
  - PROCESS-NAME,Surge 4,DIRECT
  - PROCESS-NAME,Surge%202,DIRECT
  - PROCESS-NAME,Surge%203,DIRECT
  - PROCESS-NAME,Surge%204,DIRECT
  - PROCESS-NAME,Thunder,DIRECT
  - PROCESS-NAME,DownloadService,DIRECT
  - PROCESS-NAME,qBittorrent,DIRECT
  - PROCESS-NAME,Transmission,DIRECT
  - PROCESS-NAME,fdm,DIRECT
  - PROCESS-NAME,aria2c,DIRECT
  - PROCESS-NAME,Folx,DIRECT
  - PROCESS-NAME,NetTransport,DIRECT
  - PROCESS-NAME,uTorrent,DIRECT
  - PROCESS-NAME,WebTorrent,DIRECT
  - PROCESS-NAME,aria2c.exe,DIRECT
  - PROCESS-NAME,BitComet.exe,DIRECT
  - PROCESS-NAME,fdm.exe,DIRECT
  - PROCESS-NAME,NetTransport.exe,DIRECT
  - PROCESS-NAME,qbittorrent.exe,DIRECT
  - PROCESS-NAME,Thunder.exe,DIRECT
  - PROCESS-NAME,ThunderVIP.exe,DIRECT
  - PROCESS-NAME,transmission-daemon.exe,DIRECT
  - PROCESS-NAME,transmission-qt.exe,DIRECT
  - PROCESS-NAME,uTorrent.exe,DIRECT
  - PROCESS-NAME,WebTorrent.exe,DIRECT
  - DOMAIN,clash.razord.top,DIRECT
  - DOMAIN,yacd.haishan.me,DIRECT
  - RULE-SET,applications,DIRECT
  - RULE-SET,private,DIRECT
  - RULE-SET,reject,REJECT
  - RULE-SET,icloud,DIRECT #
  - RULE-SET,apple,DIRECT # è¿™ä¸‰ä¸ªä¸ºå›½å†…å¯ç›´è¿åœ°å€ï¼Œå¦‚æœå¸Œæœ›èµ°ä»£ç†æ”¹ä¸ºğŸš€ PROXY
  - RULE-SET,google,DIRECT #
  - RULE-SET,proxy,ğŸš€ PROXY
  - RULE-SET,direct,DIRECT
  - RULE-SET,telegramcidr,ğŸš€ PROXY
  - GEOIP,LAN,DIRECT,no-resolve
  - GEOIP,CN,DIRECT,no-resolve
  - RULE-SET,lancidr,DIRECT
  - RULE-SET,cncidr,DIRECT
  - DOMAIN-SUFFIX,bilibili.com,DIRECT,tcp   #ã€Metaä¸“å±ã€‘å¯æŒ‡å®šåè®®ç±»å‹(tcp/udp)
#ã€Metaä¸“å±ã€‘é€»è¾‘åˆ¤æ–­è§„åˆ™
 # - AND,((DOMAIN,baidu.com),(NETWORK,UDP)),DIRECT #AND(å’Œ):åŸŸåä¸ºbaidu.comçš„UDPåè®®
 # - OR,((NETWORK,UDP),(DOMAIN,baidu.com)),REJECT  #OR(æˆ–):UDPçš„åè®®ï¼Œæˆ–è€…åŸŸåä¸ºbaidu.com
 # - NOT,((DOMAIN,baidu.com)),PROXY                #NOT(å¦)ï¼šåŸŸåä¸ä¸ºbaidu.comè®¿é—®
  - OR,((DOMAIN,live.yj1211.work),(DOMAIN-KEYWORD,555dy)),DIRECT
  #åŸŸåå…³é”®è¯ä¸ºbilibiliæˆ–è€…douyuçš„UDPåè®®
  - AND,((OR,((DOMAIN-KEYWORD,bilibili),(DOMAIN-KEYWORD,douyu))),(NETWORK,UDP)),REJECT
  - MATCH,ğŸš€ PROXY